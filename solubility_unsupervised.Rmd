---
title: "Solubility Unsupervised"
author: "Alicia Key"
date: "1/23/2021"
output: html_document
---

```{r setup, include=TRUE, echo = FALSE, warning = FALSE, message = FALSE, fig.align = "center"}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(readr)
library(dplyr)
library(tidyr)
```

## Load the data set

``` {r}
df <- as_tibble(read.csv("data/delaney-processed.csv")) %>%
  select(
    compound = Compound.ID, 
    mw = Molecular.Weight, 
    h_bond_donors = Number.of.H.Bond.Donors, 
    rings = Number.of.Rings, 
    rotatable_bonds = Number.of.Rotatable.Bonds, 
    psa = Polar.Surface.Area, 
    solubility = measured.log.solubility.in.mols.per.litre
)
```

## Extract a matrix

``` {r}
compound_matrix <- df %>%
  select(!c("compound", "solubility")) %>%
  as.matrix()

row.names(compound_matrix) <- df$compound
```

## Run PCA on all the numeric attributes

``` {r}
compound_pca <- prcomp(compound_matrix, scale. = TRUE, center = TRUE)
summary(compound_pca)
```

## Create the plots to explore the PCA

Ucomment the biplot if you want to see it (it takes non-trivial computation time)

``` {r}
# biplot(compound_pca)

# Scree plot
compound_pca_var <- compound_pca$sdev ^ 2
compound_pca_pve <- compound_pca_var / sum(compound_pca_var)  # Proportion variance explained

# Plot variance explained for each principal component
plot(compound_pca_pve, xlab = "Principal Component",
     ylab = "Proportion of Variance Explained",
     ylim = c(0, 1), type = "b")

# Plot cumulative proportion of variance explained
plot(cumsum(compound_pca_pve), xlab = "Principal Component",
     ylab = "Cumulative Proportion of Variance Explained",
     ylim = c(0, 1), type = "b")
```